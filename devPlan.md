# コンテナセキュリティスキャナ Web UI開発計画書

このドキュメントは、コマンドラインベースのコンテナセキュリティスキャナにWebユーザーインターフェースを追加するための開発計画を定義します。

## 1. 目的

*   コマンドライン操作に不慣れなユーザーでも、ブラウザから簡単にセキュリティスキャンを実行できるようにする。
*   スキャン結果（スコア、脆弱性リスト）を視覚的に分かりやすく表示する。
*   ツールの利便性とアクセシビリティを向上させる。

## 2. 使用技術

*   **バックエンド:** Flask (Python)
    *   理由: プロジェクトの既存コードがPythonであり、軽量で迅速なAPIサーバー構築に適しているため。
*   **フロントエンド:** HTML / CSS / JavaScript (Fetch API)
    *   理由: モダンブラウザの標準機能のみで非同期通信を実装でき、外部ライブラリへの依存を最小限に抑えられるため。
*   **CSSフレームワーク:** Bootstrap
    *   理由: クリーンでレスポンシブなデザインを迅速に構築できるため。

## 3. 開発計画

### フェーズ1: バックエンドの構築 (APIサーバー)

1.  **Flaskサーバーファイルの作成:**
    *   プロジェクトのルートディレクトリに `web_server.py` を新規作成します。

2.  **`SecurityScanner` クラスの改修:**
    *   現在の `scanner/security_scanner.py` を修正します。
    *   `print_report` メソッドを、コンソール出力から**JSONデータを返す**ように変更します。
        *   例: `return {"score": self.score, "report": self.report}`
    *   これにより、スキャナをPythonモジュールとして `web_server.py` から呼び出せるようになります。

3.  **APIエンドポイントの設計と実装 (`web_server.py`):**
    *   **`GET /`**
        *   機能: Web UIのメインページ (`index.html`) をレンダリングして返します。
    *   **`POST /api/scan`**
        *   機能: セキュリティスキャンを実行します。
        *   処理フロー:
            1.  フロントエンドからのリクエストを受け取ります。
            2.  `SecurityScanner` のインスタンスを生成し、スキャンを実行します。
            3.  `SecurityScanner` から返された結果（JSON）を、そのままフロントエンドに返します。

### フェーズ2: フロントエンドの構築 (ユーザーインターフェース)

1.  **HTMLファイルの作成:**
    *   `templates` という名前のディレクトリを新規作成します。
    *   その中に `index.html` を作成します。

2.  **UI要素の配置 (`index.html`):**
    *   **ヘッダー:** アプリケーションのタイトル（例: 「Container Security Scanner」）。
    *   **スキャンボタン:** 「スキャン開始」ボタンを配置します。IDを付けてJavaScriptから操作できるようにします（例: `id="scan-btn"`）。
    *   **ローディングインジケータ:** スキャン実行中に表示するスピナーやメッセージを配置します。普段は非表示にしておきます。
    *   **結果表示エリア:** スキャン結果を表示するためのコンテナ要素を配置します（例: `id="results-area"`）。

3.  **非同期処理の実装 (`<script>` タグ内):**
    *   スキャンボタンにクリックイベントリスナーを追加します。
    *   ボタンがクリックされたら、以下の処理を実行します。
        1.  結果表示エリアをクリアし、ローディングインジケータを表示します。
        2.  JavaScriptの `fetch` APIを使い、バックエンドの `/api/scan` エンドポイントに `POST` リクエストを送信します。
        3.  バックエンドからスキャン結果のJSONデータが返ってきたら、ローディングインジケータを非表示にします。
        4.  受け取ったJSONデータを基に、結果表示エリアのHTMLを動的に生成します。
            *   最終スコアを大きく表示します。
            *   レポートの各項目をループ処理し、リストとして表示します。
            *   脆弱性の深刻度（CRITICAL, HIGHなど）に応じて、CSSクラスを付与し、文字色や背景色を変更すると視認性が向上します。

### フェーズ3: 統合とドキュメント

1.  **動作確認:**
    *   `python web_server.py` を実行し、Webサーバーを起動します。
    *   ブラウザで `http://127.0.0.1:5001` （またはFlaskで設定したポート）にアクセスし、UIが表示されることを確認します。
    *   「スキャン開始」ボタンを押し、一連の処理が正常に完了して結果が表示されるかテストします。

2.  **READMEの更新:**
    *   プロジェクトの `README.md` に、Web UIの起動方法と使用方法に関するセクションを追加します。

## 4. ディレクトリ構成

```
container_security_scanner/
├── ddos_tool/               # Go製DDoSツール
│   ├── ddos_tool.exe
│   ├── go.mod
│   └── main.go
├── sample_app/              # 脆弱なサンプルアプリ
│   ├── app.py
│   ├── Dockerfile
│   └── requirements.txt
├── scanner/                 # Python製スキャナコア
│   └── security_scanner.py
├── templates/               # (新規) HTMLテンプレート
│   └── index.html
├── web_server.py            # (新規) Flask Webサーバー
└── web_ui_development_plan.md # (このファイル)
```
